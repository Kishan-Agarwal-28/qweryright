# Setting Up Elasticsearch (Local and Cloud)

Before we can start running queries and indexing documents, we need an Elasticsearch environment. Like Redis, there are several ways to get started, ranging from lightweight local containers to massive enterprise cloud clusters.

---

## 1. Local Setup with Docker (Recommended)

Docker is the easiest way to run Elasticsearch without worrying about Java versions or operating system conflicts.

### Running a Single-Node Cluster

Elasticsearch is designed to be a cluster, but for learning and development, we can run a "single-node" cluster locally.

Open your terminal and run:

```bash
docker run -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" --name my-elastic docker.elastic.co/elasticsearch/elasticsearch:8.10.0
```

- `-p 9200:9200`: The standard port for the **REST API** (where your app talks to Elastic).
- `-p 9300:9300`: The port for communication between nodes in a cluster.
- `-e "discovery.type=single-node"`: Tells Elasticsearch not to look for other servers to join the cluster.

### Security in Version 8

Starting with Elasticsearch 8.0, **security is enabled by default**. When the container starts, it will print a **Password** and an **Enrollment Token** to the console. Make sure to copy them! You will need them to log in.

---

## 2. Elastic Cloud (Managed Service)

If you don't want to manage servers, **Elastic Cloud** (the official offering by the creators of Elasticsearch) is the industry standard.

- **Pros:** Automatic updates, backups, monitoring, and easy scaling.
- **Trial:** They offer a 14-day free trial that includes Kibana and all premium features.
- **Provider Choice:** You can choose to run it on AWS, Google Cloud, or Microsoft Azure.

---

## 3. Kibana: The Window into Your Data

Elasticsearch is just the search engine, but you almost always use it with **Kibana**. Kibana is a web application that lets you visualize your data and run commands through a console.

### Running Kibana with Docker:

```bash
docker run --name kibana --link my-elastic:elasticsearch -p 5601:5601 docker.elastic.co/kibana/kibana:8.10.0
```

- Open your browser to `http://localhost:5601`.
- You will be asked for the enrollment token generated by the Elasticsearch container earlier.

---

## Interacting with the cluster

Once your setup is complete, you can check if it's healthy using a simple `curl` command or your browser.

```bash
# Check cluster health
curl -X GET "localhost:9200/_cluster/health?pretty"
```

### The Dev Tools Console (Kibana)

The best way to write queries while learning is the **Kibana Dev Tools Console**. It provides:

- Autocomplete for commands.
- Automatic formatting of JSON responses.
- A history of all your recent queries.

---

## Real-World Example: A Local Development Workflow

Imagine you are a developer at a startup.

1. **Local Dev:** You run a single-node Elasticsearch and Kibana using **Docker Compose** on your laptop. You write your code and test your search logic.
2. **Staging:** When you push your code, it connects to a small 3-node cluster in the **Cloud**.
3. **Production:** Your live users connect to a globally distributed, high-availability cluster on **Elastic Cloud**.

Because you used the same API everywhere, your code doesn't have to change between environments!

## Exercises

1. **Docker Command:** What does the `-p 9200:9200` part of the docker command do?
2. **Endpoint Identification:** What is the URL you would visit in your browser to see the Kibana dashboard?
3. **Security Logic:** Why did the creators of Elasticsearch decide to enable security (passwords) by default in version 8.0? (Hint: Think about open databases on the internet).

## Summary and Next Steps

Now you have an environment ready! Whether you're using Docker for speed or Elastic Cloud for convenience, you're ready to start building.

In the next lesson, we will perform our first action: **Ingesting Data**. You'll learn how to create your first index and add documents to it.
