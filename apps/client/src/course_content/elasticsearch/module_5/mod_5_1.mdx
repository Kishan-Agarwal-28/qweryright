# Nodes and Roles

Elasticsearch is designed to be a distributed cluster of servers (Nodes). However, not every node has to do every job. By assigning **Roles**, you can optimize your cluster's performance.

---

## 1. What is a Node?

A Node is simply a single running instance of Elasticsearch. On a single server, you usually run one node, but you can run multiple if you have enough RAM.

---

## 2. Core Node Roles

### A. Master-Eligible Node

The "Brain." These nodes manage the cluster state: creating indexes, deleting indexes, and tracking which nodes are healthy.

- **The Quorum:** Only one node is the "Master" at a time, but all master-eligible nodes vote on who it should be.

### B. Data Node

The "Worker." These nodes hold the actual data (shards) and perform the heavy lifting of searching and aggregating. They need fast SSDs and high RAM.

### C. Ingest Node

The "Preprocessor." These nodes run "Ingest Pipelines" to transform or enrich documents _before_ they are indexed.

- **Example:** Extracting geodata from an IP address or stripping HTML.

### D. Coordinating Node (Default)

Every node is a coordinating node. It receives the request from the client, tells the other nodes what to do, collects the results, and sends them back.

---

## 3. Dedicated Roles

In a small cluster (1-3 nodes), every node usually has every role.
In a large production cluster, you separate them:

- **3 Small Master Nodes** (to keep the cluster stable).
- **20 Large Data Nodes** (to hold 100TB of logs).
- **2 Ingest Nodes** (to handle constant log streams).

---

## Real-World Example: Black Friday Traffic

An e-commerce site expects a 10x spike in search traffic on Black Friday.

- Instead of upgrading every server, they add 10 **Dedicated Data Nodes**.
- Because the master nodes don't handle search traffic, the cluster "Brain" remains stable even as the "Workers" are working at 100% capacity.

---

## Hypothetical Scenario: The Master Node Crash

A developer decides to save money by having only 1 Master-Eligible node.

- **The Problem:** The node's CPU hits 100% and it crashes.
- **The Result:** Even though the Data nodes are fine and the data is safe, the cluster "dies" because no new indexes can be created and no node knows who the "boss" is.
- **The Lesson:** Always have at least 3 Master-Eligible nodes for high availability.

## Exercises

1. **Identification:** Which node role is responsible for storing your documents on disk?
2. **Strategy:** If your application does a lot of complex data transformations before indexing, which node role should you scale up?
3. **True/False:** A coordinating node takes the final result from all shards and merges them before replying to the user.

## Summary and Next Steps

By specializing your nodes, you can make your cluster more resilient and cost-effective. But how is the data actually split across those nodes?

Next, we look at the most important concept in Elasticsearch scaling: **Shards and Replicas**.
